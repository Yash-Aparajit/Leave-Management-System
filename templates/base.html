<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Leave Management — {% block title %}{% endblock %}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
      :root {
        --accent: #0d6efd;
        --muted: #6c757d;
        --card-radius: .9rem;
        --profile-accent: #6b5cff;
        --profile-accent-2: #4cc9f0;
      }

      body {
        background: #f7f9fc;
        font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      }

      .topbar {
        background: white;
        padding: .75rem 1rem;
        box-shadow: 0 1px 6px rgba(20,30,50,0.06);
      }

      .brand {
        font-weight: 700;
        letter-spacing: .2px;
        cursor: pointer;
      }

      .big-btn {
        min-width: 220px;
        min-height: 72px;
        font-size: 1.05rem;
        padding: .9rem 1.1rem;
        border-radius: 12px;
        display: inline-flex;
        align-items: center;
        gap: .7rem;

        font-weight: 500;
        transition: all 0.25s ease;
        box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      }

      .metric-card {
        border-radius: 12px;
        padding: 1rem;
        background: linear-gradient(180deg, #fff, #fbfdff);
        box-shadow: 0 4px 18px rgba(15,38,70,0.04);
        height: 100%;
      }

      .card-small {
        border-radius: 10px;
        padding: .7rem;
        background: white;
        box-shadow: 0 6px 18px rgba(10,20,40,0.03);
      }

      .action-grid { gap: 12px; }

      @media (max-width: 768px) {
        .big-btn { min-width: 100%; justify-content: flex-start; }
      }

      /* ===== FOOTER ===== */
      .footer {
        color: var(--muted);
        font-size: .9rem;
        padding: 1.4rem;
        text-align: center;
      }

      .footer a.profile-link {
        color: var(--profile-accent);
        font-weight: 600;
        text-decoration: none;
        position: relative;
        transition: color .25s ease;
      }

      .footer a.profile-link::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: -3px;
        width: 0;
        height: 2px;
        background: linear-gradient(
          90deg,
          var(--profile-accent),
          var(--profile-accent-2)
        );
        transition: width .3s ease;
      }

      .footer a.profile-link:hover {
        color: var(--profile-accent-2);
      }

      .footer a.profile-link:hover::after {
        width: 100%;
      }
      
      /* ================= DASHBOARD ACTION BUTTON STANDARDIZATION ================= */

      /* Normalize initial appearance for outline buttons */
      .big-btn.btn-outline-primary,
      .big-btn.btn-outline-secondary,
      .big-btn.btn-outline-success,
      .big-btn.btn-outline-danger,
      .big-btn.btn-outline-info {
        font-weight: 500;
        background-color: #fff;
      }

      /* Outline buttons → fill on hover */
      .big-btn.btn-outline-primary:hover {
        background-color: #0d6efd;
        color: #fff;
      }

      .big-btn.btn-outline-secondary:hover {
        background-color: #6c757d;
        color: #fff;
      }

      .big-btn.btn-outline-success:hover {
        background-color: #198754;
        color: #fff;
      }

      .big-btn.btn-outline-danger:hover {
        background-color: #dc3545;
        color: #fff;
      }

      .big-btn.btn-outline-info:hover {
        background-color: #0dcaf0;
        color: #000;
      }

      .big-btn.btn-outline-warning:hover {
        background-color: #ffc107;
        color: #000;
      }


      /* Ensure icons follow text color on hover */
      .big-btn i {
        transition: color 0.25s ease;
      }

      .big-btn:hover i {
        color: inherit;
      }
    </style>

    {% block head %}{% endblock %}
  </head>

  <body class="{% block body_class %}{% endblock %}">

    <!-- ================= TOP BAR ================= -->
    {% if not hide_topbar %}
    <div class="topbar d-flex align-items-center justify-content-between">

      <div class="d-flex align-items-center gap-3">
        <a href="{{ url_for('index') }}" class="brand h5 mb-0 text-decoration-none text-dark">
          Leave Manager
        </a>
        <div class="text-muted small">
          Local · v{{ system_version or '1.0' }}
        </div>
      </div>

      {% if session.get('user_id') %}
      <div class="d-flex align-items-center gap-2">

        <!-- Search -->
        <form class="d-none d-md-flex" action="{{ url_for('search') }}" method="get">
          <div class="input-group input-group-sm">
            <input
              name="q"
              class="form-control form-control-sm"
              placeholder="Search by ID or name"
              value="{{ request.args.get('q','') }}"
            >
            <button class="btn btn-outline-secondary btn-sm" type="submit">
              <i class="bi bi-search"></i>
            </button>
          </div>
        </form>

        <!-- Action Buttons -->
          <a class="btn btn-outline-success btn-sm" href="{{ url_for('month_report') }}">
            <i class="bi bi-calendar3"></i> Yearly Reports
          </a>

          <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('backup') }}">
            <i class="bi bi-cloud-arrow-up"></i> Backup
          </a>

          {% if session.get('role') in ('developer','admin_master') %}
          <a class="btn btn-outline-danger btn-sm" href="{{ url_for('restore') }}">
            <i class="bi bi-arrow-counterclockwise"></i> Restore
          </a>
          {% endif %}

          <a class="btn btn-outline-info btn-sm" href="{{ url_for('help_page') }}">
            <i class="bi bi-question-circle"></i> Help
          </a>
        </div>

        <!-- Profile Dropdown -->
        <div class="dropdown ms-2">
          <button class="btn btn-sm btn-light border dropdown-toggle" data-bs-toggle="dropdown">
            Hi {{ session.get('username') }}
            <small class="text-muted">({{ session.get('role') }})</small>
          </button>

          <ul class="dropdown-menu dropdown-menu-end">
            <li class="px-3 py-2">
              <div class="small text-muted">Signed in as</div>
              <strong>{{ session.get('username') }}</strong>
              <div class="small text-muted">{{ session.get('role') }}</div>
            </li>

            <li><hr class="dropdown-divider"></li>

            <li>
              <a class="dropdown-item" href="{{ url_for('change_password') }}">
                <i class="bi bi-key"></i> Change password
              </a>
            </li>

            <li>
              <a class="dropdown-item" href="{{ url_for('employees_list') }}">
                <i class="bi bi-people"></i> All employees
              </a>
            </li>

            <li><hr class="dropdown-divider"></li>

            <li>
              <a class="dropdown-item" href="{{ url_for('logout') }}">
                <i class="bi bi-box-arrow-right"></i> Logout
              </a>
            </li>
          </ul>
        </div>

      </div>
      {% endif %}

    </div>
    {% endif %}
    <!-- ================= END TOP BAR ================= -->

    <!-- ================= CONTENT ================= -->
    <div class="container my-4">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, msg in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show">
              {{ msg }}
              <button class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </div>

    <!-- ================= FOOTER ================= -->
    <div class="footer">
      <h6>
        Leave Management System • Built by
        <a href="{{ url_for('profile') }}" class="profile-link">
          Yash Aparajit
        </a>
        {{ build_date or '' }}
      </h6>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
  </body>
</html>
