{% extends 'base.html' %}
{% block title %}Edit Leave — {{ emp.employee_id }}{% endblock %}

{% block content %}
<a class="btn btn-outline-secondary back-btn" href="{{ url_for('employee_detail', emp_id=emp.id) }}">
  <i class="bi bi-arrow-left"></i> Back
</a>

<div class="card p-3">
  <h4 class="mb-3">Edit Leave Entry</h4>

  <div class="mb-3">
    <strong>{{ emp.employee_id }}</strong> —
    {{ emp.first_name }} {{ emp.last_name }}
    {% if emp.department %}<span class="text-muted">({{ emp.department }})</span>{% endif %}
  </div>

  <form method="post" class="row g-3">
    <div class="col-md-3">
      <label class="form-label">Date from</label>
      <input type="date" name="date_from" class="form-control" value="{{ le.date_from|nice_date }}" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">Date to</label>
      <input type="date" name="date_to" class="form-control" value="{{ le.date_to|nice_date }}" required>
    </div>
    <div class="col-md-2">
      <label class="form-label">No. of days</label>
      <input type="number" step="0.5" min="0" name="days" class="form-control" value="{{ le.days }}" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Situation</label>
      <select name="situation" class="form-select">
        <option value="">-- Select (optional) --</option>
        <option value="Planned" {% if le.situation == 'Planned' %}selected{% endif %}>Planned</option>
        <option value="Unplanned" {% if le.situation == 'Unplanned' %}selected{% endif %}>Unplanned</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">Leave type</label>
      <select name="leave_type_id" class="form-select" required>
        {% for lt in leave_types %}
          <option value="{{ lt.id }}" {% if le.leave_type_id == lt.id %}selected{% endif %}>
            {{ lt.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label">Approved by</label>
      <input type="text" name="approver" class="form-control"
             placeholder="Person who approved the leave"
             value="{{ le.approver if le.approver is defined and le.approver else '' }}">
      <div class="form-text">Optional, e.g. Plant Head, HR Head, Executive Director…</div>
    </div>

    <div class="col-12">
      <label class="form-label">Reason / notes</label>
      <textarea name="reason" class="form-control" rows="2"
                placeholder="Reason for leave (optional)">{{ le.reason or '' }}</textarea>
    </div>

    <div class="col-12 mt-3">
      <button class="btn btn-primary" type="submit">
        <i class="bi bi-save"></i> Save changes
      </button>
    </div>
  </form>
</div>
{% endblock %}
